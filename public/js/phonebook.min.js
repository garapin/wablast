let activePhoneBook;function processLoadMore(){$(".load-more").html('<i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i> Loading...'),$(".load-more").attr("disabled",!0)}function processLoadMoreDone(){$(".load-more").html("Load More"),$(".load-more").attr("disabled",!1),$(".phone-book-list").animate({scrollTop:$(".phone-book-list").prop("scrollHeight")},1e3)}function getPhoneBook(t=1,e=""){t>1&&processLoadMore(),$.ajax({url:"/get-phonebook?page="+t+"&search="+e,method:"GET",dataType:"json",success:function(e){1==t&&$(".phone-book-list").empty(),$(".phone-book-list").append(e.html),$(".load-phonebook").empty(),e.current_page==e.last_page?$(".load-more").hide():(t>1&&processLoadMoreDone(),$(".load-more").attr("data-page",e.current_page+1),$(".load-more").show())}})}function getContact(t,e=1,o=""){$.ajax({url:`/get-contact/${t}?page=${e}&search=${o}`,dataType:"json",method:"GET",success:function(o){1==e?$(".contacts-list").html(o.html):($(".contacts-list").append(o.html),$(".contacts-list .load-more-contact").remove()),activePhoneBook=t,o.start_page<o.last_page&&$(".contacts-list").append(`<div class="text-center mt-3"> <button class="btn btn-sm load-more-contact" data-page="${o.start_page+1}" data-phonebook-id="${t}"
                    >Load More</button> </div>`)}})}function clickPhoneBook(t,e){$(".contacts-list").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),$(".single-phonebook").removeClass("active"),$(e).addClass("active"),getContact(t)}function addContact(){if(void 0==activePhoneBook){toastr.warning("Please select phonebook");return}$("#addContact").modal("show")}function deleteContact(t){$.ajax({url:`/contact/delete/${t}`,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"DELETE",dataType:"json",success:function(e){if(e.error){toastr.error(e.msg);return}toastr.success(e.msg),$(`#contact-${t}`).remove()}})}function deleteAllContact(){if(void 0===activePhoneBook){toastr.warning("Please select phonebook");return}if(confirm("Are you sure you want to delete all contacts?"))$.ajax({url:`/contact/delete-all/${activePhoneBook}`,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"DELETE",dataType:"json",success:function(t){if(t.error){toastr.error(t.msg);return}toastr.success(t.msg),$(".contacts-list").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),getContact(activePhoneBook)}});else{toastr.warning("Delete all contacts canceled");return}}function importContact(){if(void 0==activePhoneBook){toastr.warning("Please select phonebook");return}$("#importContacts").modal("show")}function exportContact(){if(void 0==activePhoneBook){toastr.warning("Please select phonebook");return}window.location.href=`/contact/export/${activePhoneBook}`}$(document).ready(function(){$(".load-phonebook").append(' <i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i>'),getPhoneBook(),$(".load-more").click(function(){var t=$(this).attr("data-page");$(this).html('<i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i> Loading...'),getPhoneBook(t)})}),$(document).on("click",".load-more-contact",function(){var t=$(this).attr("data-page");let e=$(this).attr("data-phonebook-id");$(this).html('<i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i> Loading...'),getContact(e,t)}),$(".search-contact").on("keyup",function(){if(void 0!=activePhoneBook){var t=$(this).val();clearTimeout($.data(this,"timer"));var e=setTimeout(function(){$(".contacts-list").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),getContact(activePhoneBook,1,t)},500);$(this).data("timer",e)}}),$(".search-phonebook").on("keyup",function(){var t=$(this).val();clearTimeout($.data(this,"timer")),setTimeout(function(){$(".load-phonebook").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),getPhoneBook(1,t)},500)}),$(".add-contact-form").submit(function(t){t.preventDefault();let e=activePhoneBook;$(".input_phonebookid").val(e);let o=$(this).serialize();$.ajax({url:"/contact/store",method:"POST",data:o,dataType:"json",success:function(t){if(t.error){toastr.error(t.msg);return}toastr.success(t.msg),$("#addContact").modal("hide"),$(".contacts-list").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),$(".add-contact-form")[0].reset(),getContact(activePhoneBook)}})}),$("#import-contact-form").submit(function(t){t.preventDefault();let e=new FormData(this);e.append("phonebook_id",activePhoneBook),e.append("_token",$('meta[name="csrf-token"]').attr("content")),e.append("file",$("#fileContacts")[0].files[0]),$.ajax({url:"/contact/import",method:"POST",data:e,dataType:"json",contentType:!1,processData:!1,success:function(t){if(console.log(t),t.error){toastr.error(t.msg);return}toastr.success(t.msg),$("#importContacts").modal("hide"),$(".contacts-list").html('<div class="d-flex justify-content-center align-items-center" style="height: 100%;"><i class="bx bx-loader bx-spin font-size-18 text-primary me-2"></i></div>'),$("#import-contact-form")[0].reset(),getContact(activePhoneBook)}})});